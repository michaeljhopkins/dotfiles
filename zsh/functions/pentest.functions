#!/usr/bin/env bash

# Make it easier to put multiple interfaces into Mon mode and set to the standard channels 1,6,11.
# Expects 1 argument for the tcpdump file name to be placed in ~/pcaps/argumentXX
# Example `masstcpdump specificLocation`
function masstcpdump () {
	LOOP=1
	for f in `iwconfig 2>/dev/null | grep -o "^wlan[1-9]\+"`; do
		#echo "sudo ifconfig ${f} down"
		`sudo ifconfig ${f} down`
		#echo "sudo iwconfig ${f} mode Monitor"
		`sudo iwconfig ${f} mode Monitor`
		#echo "sudo ifconfig ${f} up"
		`sudo ifconfig ${f} up`
		if [[ $LOOP -eq 1 ]]; then
			sudo iw dev $f set channel 1
		elif [[ $LOOP -eq 2 ]]; then
			sudo iw dev $f set channel 6
		else
			sudo iw dev $f set channel 11
		fi
		#echo $ARGS
		#echo "sudo tcpdump ${ARGS}"
		sudo tcpdump -s0 -C 50 -W 50 -w "/home/m/pcaps/${f}_${1}" -nni $f -s 0 ip &
		LOOP=$((LOOP + 1))
	done
}

# Those pesky services that are constantly needing to be brought up and down. `networks start` or `networks stop`
function networks() {
    sudo service networking $1
    sudo service network-manager $1
}